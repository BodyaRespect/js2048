let e=[],n=0,t=!1;const o=document.querySelector(".tileContainer"),r=document.getElementById("scoreElement"),i=document.getElementById("alert");function l(){for(let n=0;n<4;n++){let n=[];for(let e=0;e<4;e++)n.push(0);e.push(n)}}function a(){i.style.display="none",o.innerHTML="",r.innerHTML=0,e=[],n=0,t=!1,window.addEventListener("keydown",d),l(),w(),w()}function s(){i.style.display="none",window.addEventListener("keydown",d)}function d(n){let o;switch(n.key){case"ArrowUp":o=m(1,0);break;case"ArrowDown":o=m(-1,0);break;case"ArrowLeft":o=m(0,-1);break;case"ArrowRight":o=m(0,1)}if(o){w();let n=function(){let n=!1;for(let o=0;o<e.length;o++)for(let r=0;r<e[o].length;r++){if(0===e[o][r]&&(n=!0),2048===e[o][r]&&!t)return{gameOver:!0,message:"You won!"};3!==r&&e[o][r]===e[o][r+1]&&(n=!0),3!==o&&e[o][r]===e[o+1][r]&&(n=!0)}return n?{gameOver:!1,message:""}:{gameOver:!0,message:"Game over!"}}();n.gameOver&&function(e){if(i.innerHTML="","Game over!"===e||"You won!"===e){let n=[{text:"Game over!"===e?"Try again":"New game",handler:a}];"You won!"===e&&(n.push({text:"Continue",handler:s}),t=!0,window.removeEventListener("keydown",d));let o=function(e,n){let t=document.createElement("div");return i.innerText=e,n.forEach(e=>{let n=document.createElement("button");n.innerText=e.text,n.onclick=e.handler,t.appendChild(n)}),t}(e,n);i.appendChild(o)}i.style.display="flex",i.style.flexDirection="column"}(n.message)}}function c(e,n,t){return e<=t&&1===n||e>=0&&-1===n}function m(t,o){let i=!1,l=!1;if(0!==o){let t=1===o?3:0,a=1===o?-1:1;for(let s=0;s<4;s++){let d=t;for(;c(d,a,3);){if(0===e[s][d]){d+=a;continue}let t=f(s,d,0,o),c=".row"+(s+1)+".column"+(d+1),m=document.querySelector(c);if(!t.merge||t.merge&&l){l=!1,t.destinationX+=t.merge?a:0,e[s][t.destinationX]=e[s][d],t.destinationX!==d&&(i=!0,e[s][d]=0),g(s,t.destinationX,m,!1),d+=a;continue}l=!0,e[s][t.destinationX]=2*e[s][d],n+=e[s][t.destinationX],r.innerHTML=n,i=!0,e[s][d]=0,g(s,t.destinationX,m,t.merge),d+=a}}}else if(0!==t){let o=1===t?3:0,a=1===t?-1:1;for(let s=0;s<4;s++){let d=o;for(;c(d,a,3);){if(0===e[d][s]){d+=a;continue}let o=f(d,s,t,0),c=".row"+(d+1)+".column"+(s+1),m=document.querySelector(c);if(!o.merge||o.merge&&l){l=!1,o.destinationY+=o.merge?a:0,e[o.destinationY][s]=e[d][s],o.destinationY!==d&&(i=!0,e[d][s]=0),g(o.destinationY,s,m,!1),d+=a;continue}l=!0,e[o.destinationY][s]=2*e[d][s],n+=e[o.destinationY][s],r.innerHTML=n,i=!0,e[d][s]=0,g(o.destinationY,s,m,o.merge),d+=a}}}return i}function u(e,n,t,o){return 1===e&&n<t&&!o||-1===e&&n>0&&!o}function f(n,t,o,r){let i=n,l=t,a=!1;for(;u(o,i,3,a)||u(r,l,3,a);){let s=i+o,d=l+r,c=e[s][d],m=e[n][t];if(a)break;if(0===c||c===m)i=s,l=d,a=c===m;else if(0!==c&&c!==m)break}return{merge:a,destinationY:i,destinationX:l}}function g(n,t,r,i){if(Array.from(r.classList).forEach(e=>{(e.startsWith("row")||e.startsWith("column"))&&r.classList.remove(e)}),r.classList.add("row"+(n+1),"column"+(t+1)),i){let i=o.querySelectorAll(".row"+(n+1)+".column"+(t+1));for(;i.length>1;)o.removeChild(i[0]),i=o.querySelectorAll(".row"+(n+1)+".column"+(t+1));i[0].className="tile row"+(n+1)+" column"+(t+1)+" value"+e[n][t],i[0].innerHTML=e[n][t],i[0].classList.add("merged"),i[0].addEventListener("animationend",()=>r.classList.remove("merged"))}}function w(){let n=[];for(let t=0;t<e.length;t++)for(let o=0;o<e[t].length;o++)0===e[t][o]&&n.push([t,o]);let[t,r]=n[Math.floor(Math.random()*n.length)];e[t][r]=.9>Math.random()?2:4,function(e,n,t){let r=document.createElement("div");r.classList.add("tile","row"+(e+1),"column"+(n+1),"value"+t),r.innerHTML=t,o.appendChild(r),r.classList.add("merged"),r.addEventListener("animationend",()=>r.classList.remove("merged"))}(t,r,e[t][r])}document.getElementById("newGame").addEventListener("click",a),l(),w(),w(),window.addEventListener("keydown",d);
//# sourceMappingURL=index.3c9e3d78.js.map
